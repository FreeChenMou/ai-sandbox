# AI Sandbox å¼€å‘è®¡åˆ’

æœ¬æ–‡æ¡£å®šä¹‰äº† ai-sandbox é¡¹ç›®çš„æ¨¡å—åŒ–å¼€å‘é¡ºåºã€æ¯ä¸ªæ¨¡å—çš„æŠ€æœ¯ç»†èŠ‚ã€éªŒæ”¶æ ‡å‡†å’Œæ—¶é—´é¢„ä¼°ã€‚

## ğŸ“‹ å¿«é€Ÿå¯¼èˆª

### å¼€å‘é˜¶æ®µæ¦‚è§ˆ

| é˜¶æ®µ | å‘¨æ¬¡ | æ¨¡å—æ•° | ä¸»é¢˜ | çŠ¶æ€ |
|------|------|--------|------|------|
| [**é˜¶æ®µ1**](./docs/development/phase-1-isolation.md) | 1-2å‘¨ | 3ä¸ª | åŸºç¡€éš”ç¦» | ğŸ”´ å…³é”®è·¯å¾„ |
| [**é˜¶æ®µ2**](./docs/development/phase-2-permission.md) | 3-4å‘¨ | 3ä¸ª | æƒé™æ§åˆ¶ | ğŸŸ  å®‰å…¨å…³é”® |
| [**é˜¶æ®µ3**](./docs/development/phase-3-snapshot.md) | 5-6å‘¨ | 2ä¸ª | å¿«ç…§æ¢å¤ | ğŸŸ¡ æ€§èƒ½ä¼˜åŒ– |
| [**é˜¶æ®µ4**](./docs/development/phase-4-orchestration.md) | 7-9å‘¨ | 3ä¸ª | Workflowç¼–æ’ | ğŸŸ¢ åº”ç”¨å±‚ |
| [**é˜¶æ®µ5**](./docs/development/phase-5-enhancement.md) | 10+å‘¨ | 2ä¸ª | å¯é€‰å¢å¼º | ğŸ”µ é«˜çº§èƒ½åŠ› |

### æ¨¡å—è¯¦ç»†åˆ—è¡¨

#### é˜¶æ®µ1ï¼šåŸºç¡€éš”ç¦»ï¼ˆå…³é”®è·¯å¾„ï¼‰
- [1.1 Namespaceéš”ç¦»](./docs/development/modules/module-1.1-namespace.md)
- [1.2 OverlayFSæ–‡ä»¶ç³»ç»Ÿ](./docs/development/modules/module-1.2-overlayfs.md)
- [1.3 Cgroups v2èµ„æºé™åˆ¶](./docs/development/modules/module-1.3-cgroups.md)

#### é˜¶æ®µ2ï¼šæƒé™æ§åˆ¶ï¼ˆå®‰å…¨å…³é”®ï¼‰
- [2.1 Seccomp-BPFç³»ç»Ÿè°ƒç”¨è¿‡æ»¤](./docs/development/modules/module-2.1-seccomp.md)
- [2.2 Chroot/Pivot Rootéš”ç¦»](./docs/development/modules/module-2.2-chroot.md)
- [2.3 Sidecar Proxy APIå®¡è®¡](./docs/development/modules/module-2.3-proxy.md)

#### é˜¶æ®µ3ï¼šå¿«ç…§æ¢å¤ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
- [3.1 CRIUå¿«ç…§é›†æˆ](./docs/development/modules/module-3.1-criu.md)
- [3.2 çƒ­å¯åŠ¨ä¼˜åŒ–](./docs/development/modules/module-3.2-warmup.md)

#### é˜¶æ®µ4ï¼šWorkflowç¼–æ’ï¼ˆåº”ç”¨å±‚ï¼‰
- [4.1 DAGæ‰§è¡Œå¼•æ“](./docs/development/modules/module-4.1-dag.md)
- [4.2 è°ƒåº¦å™¨å’Œèµ„æºç®¡ç†](./docs/development/modules/module-4.2-scheduler.md)
- [4.3 æ•…éšœæ¢å¤](./docs/development/modules/module-4.3-recovery.md)

#### é˜¶æ®µ5ï¼šå¯é€‰å¢å¼ºï¼ˆé«˜çº§èƒ½åŠ›ï¼‰
- [5.1 eBPF Syscallè¿½è¸ª](./docs/development/modules/module-5.1-ebpf.md)
- [5.2 å¼‚å¸¸æ£€æµ‹å’ŒåŠ¨æ€æ§åˆ¶](./docs/development/modules/module-5.2-detection.md)

---

## ğŸ¯ æ ¸å¿ƒé‡Œç¨‹ç¢‘

### ç¬¬2å‘¨æœ«ï¼šåŸºç¡€éš”ç¦»MVP
**äº¤ä»˜å†…å®¹**ï¼šèƒ½åˆ›å»ºå’Œè¿è¡Œéš”ç¦»çš„Agentæ²™ç®±

```bash
# åŠŸèƒ½æ¼”ç¤º
./ai-sandbox run --cpu 1 --memory 512MB python agent_script.py
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… èƒ½åˆ›å»ºç‹¬ç«‹çš„Namespaceç¯å¢ƒ
- âœ… èƒ½æŒ‚è½½OverlayFSå¹¶éš”ç¦»æ–‡ä»¶ç³»ç»Ÿ
- âœ… èƒ½é™åˆ¶Agentçš„CPUå’Œå†…å­˜
- âœ… Agentå®Œæˆåç¯å¢ƒè¢«æ­£ç¡®æ¸…ç†

**å…³é”®æ–‡æ¡£**ï¼š[é˜¶æ®µ1è¯¦ç»†è§„åˆ’](./docs/development/phase-1-isolation.md)

---

### ç¬¬4å‘¨æœ«ï¼šå®‰å…¨éš”ç¦»
**äº¤ä»˜å†…å®¹**ï¼šèƒ½å®‰å…¨åœ°æ‰§è¡ŒAgentï¼Œæ‹¦æˆªæ¶æ„ç³»ç»Ÿè°ƒç”¨

```bash
# åŠŸèƒ½æ¼”ç¤º
./ai-sandbox run --policy strict python malicious_agent.py
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… æ¶æ„ç³»ç»Ÿè°ƒç”¨è¢«å†…æ ¸æ‹¦æˆª
- âœ… Agentè¢«å®‰å…¨killï¼Œæ— ä¿¡æ¯æ³„éœ²
- âœ… Seccompè§„åˆ™åŠ è½½å’Œç”Ÿæ•ˆ
- âœ… åŒå±‚é˜²æŠ¤ï¼šSeccomp + Chroot

**å…³é”®æ–‡æ¡£**ï¼š[é˜¶æ®µ2è¯¦ç»†è§„åˆ’](./docs/development/phase-2-permission.md)

---

### ç¬¬6å‘¨æœ«ï¼šå¿«ç…§æ¢å¤
**äº¤ä»˜å†…å®¹**ï¼šæ”¯æŒAgentå¿«ç…§å’Œæ•…éšœå¿«é€Ÿæ¢å¤

```bash
# åŠŸèƒ½æ¼”ç¤º
# Task1å¤±è´¥ â†’ ä¿å­˜å¿«ç…§
# Task2ä»å¿«ç…§å¿«é€Ÿæ¢å¤ (<500ms) â†’ ç»§ç»­æ‰§è¡Œ
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… èƒ½å¯¹è¿è¡Œçš„è¿›ç¨‹åšCRIUå¿«ç…§
- âœ… å¿«ç…§æ–‡ä»¶å®Œæ•´ä¸”å¯æ¢å¤
- âœ… æ¢å¤åè¿›ç¨‹çŠ¶æ€ä¸€è‡´
- âœ… æ¢å¤æ—¶é—´<500ms

**å…³é”®æ–‡æ¡£**ï¼š[é˜¶æ®µ3è¯¦ç»†è§„åˆ’](./docs/development/phase-3-snapshot.md)

---

### ç¬¬9å‘¨æœ«ï¼šå®Œæ•´Workflowå¼•æ“
**äº¤ä»˜å†…å®¹**ï¼šæ”¯æŒé¡ºåºã€å¹¶è¡Œã€å¹¶å‘çš„å®Œæ•´å·¥ä½œæµç¼–æ’

```bash
# åŠŸèƒ½æ¼”ç¤º
# 100ä¸ªå¹¶å‘Agentï¼ŒCPUæ€»é¢é™åˆ¶8æ ¸
./ai-sandbox orchestrate --config workflow.yaml
```

**éªŒæ”¶æ ‡å‡†**ï¼š
- âœ… æ”¯æŒé¡ºåºä»»åŠ¡ä¾æ¬¡æ‰§è¡Œ
- âœ… æ”¯æŒå¹¶è¡Œä»»åŠ¡åŒæ—¶å¯åŠ¨å’Œç­‰å¾…
- âœ… æ”¯æŒå¹¶å‘ä»»åŠ¡åŠ¨æ€è°ƒåº¦
- âœ… èµ„æºæ€»é‡é™åˆ¶ç”Ÿæ•ˆ
- âœ… æ•…éšœä»»åŠ¡èƒ½è‡ªåŠ¨æ¢å¤

**å…³é”®æ–‡æ¡£**ï¼š[é˜¶æ®µ4è¯¦ç»†è§„åˆ’](./docs/development/phase-4-orchestration.md)

---

## ğŸ“Š å¼€å‘æ—¶é—´è¡¨

```
Week:       1    2    3    4    5    6    7    8    9    10+
            |    |    |    |    |    |    |    |    |    |
é˜¶æ®µ1:      [========éš”ç¦»å±‚========]
é˜¶æ®µ2:                [==æƒé™æ§åˆ¶==]
é˜¶æ®µ3:                             [==å¿«ç…§æœºåˆ¶==]
é˜¶æ®µ4:                                          [====Workflow====]
é˜¶æ®µ5:                                                       [å¢å¼º]

MVPéªŒè¯:    âœ“    âœ“    âœ“    âœ“    âœ“    âœ“    âœ“
           åŸºç¡€ éš”ç¦» å®‰å…¨ å¿«ç…§ æ¢å¤ DAG  å®Œæ•´
```

---

## ğŸ‘¥ å›¢é˜Ÿåˆ†å·¥å»ºè®®

å‡è®¾å›¢é˜Ÿ3äººï¼š

### äººå‘˜Aï¼šç³»ç»Ÿç¼–ç¨‹ä¸“å®¶
```
å‘¨1-2ï¼šNamespace + OverlayFS
å‘¨3-4ï¼šSeccomp-BPF
å‘¨5-6ï¼šCRIUå¿«ç…§
å‘¨7+ï¼šeBPFï¼ˆå¯é€‰å¢å¼ºï¼‰
```

### äººå‘˜Bï¼šåº”ç”¨æ¶æ„å¸ˆ
```
å‘¨2-3ï¼šå­¦ä¹ éš”ç¦»å±‚ï¼Œè®¾è®¡DAGå¼•æ“
å‘¨4-6ï¼šå¹¶è¡Œè®¾è®¡DAGå’Œè°ƒåº¦å™¨
å‘¨7-9ï¼šDAGæ‰§è¡Œã€è°ƒåº¦å™¨ã€æ•…éšœæ¢å¤
å‘¨9+ï¼šæ€§èƒ½ä¼˜åŒ–å’Œæ–‡æ¡£
```

### äººå‘˜Cï¼šæµ‹è¯•/å·¥å…·å·¥ç¨‹å¸ˆ
```
å‘¨1-9ï¼šæ¯ä¸ªæ¨¡å—çš„æµ‹è¯•ç”¨ä¾‹ç¼–å†™
å‘¨3+ï¼šæ€§èƒ½åŸºå‡†æµ‹è¯•å»ºç«‹
å‘¨5+ï¼šæ•…éšœæ³¨å…¥å’Œå‹åŠ›æµ‹è¯•
å‘¨7+ï¼šé›†æˆæµ‹è¯•å’Œæ–‡æ¡£
```

---

## ğŸ” æ¨¡å—ä¾èµ–å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åº”ç”¨å±‚ï¼šWorkflowç¼–æ’å¼•æ“                     â”‚
â”‚         DAGæ‰§è¡Œã€è°ƒåº¦ã€æ•…éšœæ¢å¤                      â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                      â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ ä¾èµ–
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ ¸å¿ƒéš”ç¦»å±‚        â”‚         â”‚ å¢å¼ºå±‚(å¯é€‰)        â”‚
â”‚ (å¿…é€‰)            â”‚         â”‚ eBPF/LSM/Notify    â”‚
â”‚                  â”‚         â”‚ (æŒ‰éœ€å¯ç”¨)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â€¢ Namespace      â”‚
â”‚ â€¢ OverlayFS      â”‚
â”‚ â€¢ Cgroups        â”‚
â”‚ â€¢ Seccomp        â”‚
â”‚ â€¢ Chroot         â”‚
â”‚ â€¢ CRIUå¿«ç…§       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¾èµ–è¯´æ˜**ï¼š
- é˜¶æ®µ1ï¼ˆéš”ç¦»ï¼‰æ˜¯åŸºç¡€ï¼Œæ‰€æœ‰å…¶ä»–æ¨¡å—éƒ½ä¾èµ–å®ƒ
- é˜¶æ®µ2ï¼ˆæƒé™ï¼‰ä¾èµ–é˜¶æ®µ1ï¼Œå¯ä¸é˜¶æ®µ1åæœŸå¹¶è¡Œ
- é˜¶æ®µ3ï¼ˆå¿«ç…§ï¼‰å®Œå…¨ä¾èµ–é˜¶æ®µ1å’Œ2
- é˜¶æ®µ4ï¼ˆç¼–æ’ï¼‰ä¾èµ–æ‰€æœ‰å‰ç»­é˜¶æ®µ
- é˜¶æ®µ5ï¼ˆå¢å¼ºï¼‰å®Œå…¨å¯é€‰ï¼Œä¸é˜»å¡å‰ç»­å¼€å‘

---

## âš ï¸ å…³é”®é£é™©å’Œåº”å¯¹

| é£é™© | å¯èƒ½æ€§ | å½±å“ | åº”å¯¹æ–¹æ¡ˆ |
|------|-------|------|---------|
| **CRIUå…¼å®¹æ€§é—®é¢˜** | é«˜ | å¿«ç…§åŠŸèƒ½å¤±æ•ˆ | ç¬¬1å‘¨åšPoCéªŒè¯ï¼Œé€‰æ‹©ç¨³å®šå†…æ ¸ç‰ˆæœ¬ |
| **Seccompè§„åˆ™è¿‡ä¸¥** | ä¸­ | Agentæ— æ³•æ‰§è¡Œæ­£å¸¸ä»»åŠ¡ | å»ºç«‹ç™½åå•è§„åˆ™åº“ï¼Œå¾ªç¯è¿­ä»£ä¼˜åŒ– |
| **å¯åŠ¨æ€§èƒ½è¾¾ä¸åˆ°50ms** | ä¸­ | å½±å“ç”¨æˆ·ä½“éªŒ | æ—©æœŸæ€§èƒ½åŸºå‡†æµ‹è¯•ï¼Œå¿«ç…§é¢„çƒ­ |
| **Cgroupsè¡Œä¸ºä¸ç¬¦é¢„æœŸ** | ä½ | èµ„æºéš”ç¦»å¤±æ•ˆ | å……åˆ†çš„å•å…ƒæµ‹è¯•å’Œå‹åŠ›æµ‹è¯• |

**é£é™©ç¼“è§£**ï¼š
1. ç¬¬1å‘¨å®ŒæˆåŸºç¡€æŠ€æœ¯PoCéªŒè¯
2. æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„éªŒæ”¶æ ‡å‡†
3. å…³é”®æ¨¡å—ç‹¬ç«‹æµ‹è¯•ï¼Œä¸ä¾èµ–æ•´ä½“é›†æˆ
4. æå‰è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•

---

## ğŸ“š æŠ€æœ¯å‚è€ƒ

### å…³é”®ç³»ç»Ÿè°ƒç”¨
- [Namespaceç³»ç»Ÿè°ƒç”¨](./docs/development/references/syscalls-namespace.md)
- [Cgroupsæ¥å£](./docs/development/references/cgroups-interface.md)
- [Seccomp-BPF](./docs/development/references/seccomp-bpf.md)
- [CRIUæ£€æŸ¥ç‚¹](./docs/development/references/criu-checkpoint.md)

### æ€§èƒ½æŒ‡æ ‡åŸºå‡†
- [æ€§èƒ½ç›®æ ‡](./docs/development/references/performance-targets.md)
- [èµ„æºå ç”¨é¢„ä¼°](./docs/development/references/resource-estimation.md)

### æµ‹è¯•ç­–ç•¥
- [å•å…ƒæµ‹è¯•æŒ‡å—](./docs/development/testing/unit-testing.md)
- [é›†æˆæµ‹è¯•æŒ‡å—](./docs/development/testing/integration-testing.md)
- [æ€§èƒ½æµ‹è¯•](./docs/development/testing/performance-testing.md)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ¨¡å—çš„è¯¦ç»†è§„åˆ’

```bash
# æŸ¥çœ‹é˜¶æ®µ1è¯¦ç»†è§„åˆ’
cat docs/development/phase-1-isolation.md

# æŸ¥çœ‹Namespaceæ¨¡å—çš„å®ç°ç»†èŠ‚
cat docs/development/modules/module-1.1-namespace.md
```

### æäº¤æ–°çš„è®¾è®¡å†³ç­–

å¦‚æœåœ¨å¼€å‘ä¸­éœ€è¦ä¿®æ”¹è®¡åˆ’ï¼Œè¯·ï¼š
1. åœ¨ç›¸åº”çš„æ¨¡å—æ–‡ä»¶ä¸­æ›´æ–°
2. åœ¨æœ¬æ–‡æ¡£çš„"å˜æ›´è®°å½•"ä¸­è®°å½•åŸå› 
3. é€šçŸ¥å›¢é˜Ÿ

---

## ğŸ“ å˜æ›´è®°å½•

| æ—¥æœŸ | å˜æ›´ | åŸå›  | å®¡æ‰¹äºº |
|------|------|------|--------|
| 2024-02-10 | åˆç‰ˆå‘å¸ƒ | é¡¹ç›®å¯åŠ¨ | - |

---

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®æŠ€æœ¯è´Ÿè´£äººï¼š[å¾…å®š]
- é¡¹ç›®ç®¡ç†ï¼š[å¾…å®š]
- é—®é¢˜è·Ÿè¸ªï¼š[é¡¹ç›®issue]

---

**æœ€åæ›´æ–°**ï¼š2024-02-10
**ç‰ˆæœ¬**ï¼š1.0
